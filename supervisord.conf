[supervisord]
nodaemon=true

[program:postgres]
command=/usr/lib/postgresql/14/bin/postgres -D /var/lib/postgresql/data
autostart=true
autorestart=true
priority=10

[program:redis]
command=/usr/bin/redis-server
autostart=true
autorestart=true
priority=20

[program:backend]
directory=/app/backend
command=sh -c "python manage.py migrate && gunicorn app:app --bind 127.0.0.1:8000 --workers 4"
autostart=true
autorestart=true
priority=30

[program:celery]
directory=/app/backend
command=celery -A app worker --loglevel=info
autostart=true
autorestart=true
priority=40

[program:celerybeat]
directory=/app/backend
command=celery -A app beat --loglevel=info
autostart=true
autorestart=true
priority=50

[program:frontend]
directory=/app/frontend
command=npm run start
autostart=true
autorestart=true
priority=60
